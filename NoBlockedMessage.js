function F(o){window.enmity.plugins.registerPlugin(o)}const w=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const n=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage,window.enmity.modules.common.Toasts,window.enmity.modules.common.Dialog,window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings,window.enmity.modules.common.Users;const A=window.enmity.modules.common.Navigation;window.enmity.modules.common.NavigationNative,window.enmity.modules.common.NavigationStack,window.enmity.modules.common.Theme;const S=window.enmity.modules.common.Linking,_=window.enmity.modules.common.StyleSheet;window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;function I(o){return window.enmity.patcher.create(o)}var g="NoBlockedMessage",f="1.0.0",k="Completely remove blocked messages from your chat view",B=[{name:"mafu",id:"519760564755365888"}],R="#f5deb3",M={name:g,version:f,description:k,authors:B,color:R};function D(o,t){return window.enmity.modules.getModule(o,t)}function v(...o){return window.enmity.modules.getByProps(...o)}window.enmity.modules.common;const{components:e}=window.enmity;e.Alert,e.Button,e.FlatList;const L=e.Image;e.ImageBackground,e.KeyboardAvoidingView,e.Modal,e.Pressable,e.RefreshControl;const N=e.ScrollView;e.SectionList,e.StatusBar,e.StyleSheet,e.Switch;const y=e.Text;e.TextInput,e.TouchableHighlight,e.TouchableOpacity,e.TouchableWithoutFeedback,e.Touchable;const E=e.View;e.VirtualizedList,e.Form,e.FormArrow,e.FormCTA,e.FormCTAButton,e.FormCardSection,e.FormCheckbox,e.FormDivider,e.FormHint,e.FormIcon,e.FormInput,e.FormLabel,e.FormRadio;const i=e.FormRow,T=e.FormSection;e.FormSelect,e.FormSubLabel;const P=e.FormSwitch;e.FormTernaryCheckBox,e.FormText,e.FormTextColors,e.FormTextSizes;const x=D(o=>o._dispatcher._actionHandlers._dependencyGraph.nodes),h=x._dispatcher._actionHandlers._dependencyGraph.nodes;function H(o){let t=Object.keys(h).filter(m=>h[m].name===o);if(t.length)return h[t[0]].actionHandler}function b(o,t,m){return window.enmity.settings.get(o,t,m)}function a(o){return window.enmity.assets.getIDByName(o)}const{native:c}=window.enmity;function V(){c.reload()}c.version,c.build,c.device,c.version;const G=a("ic_message_retry"),O=a("ic_hide"),U=a("img_account_sync_github_white"),z=a("Discord"),Y=a("img_account_sync_twitter_white"),j=v("acceptInviteAndTransitionToInviteChannel");var q=({settings:o})=>{const t=_.createThemedStyleSheet({container:{flexDirection:"row",justifyContent:"center",alignItems:"center"},image:{width:70,height:70,marginTop:20,marginLeft:20},title:{flexDirection:"column"},name:{fontSize:30,paddingTop:20,paddingLeft:20,paddingRight:30,color:w.ThemeColorMap.HEADER_PRIMARY},author:{fontSize:15,paddingLeft:50,color:w.ThemeColorMap.HEADER_SECONDARY},info:{height:45,paddingTop:3,paddingBottom:3,justifyContent:"center",alignItems:"center"},footer:{color:w.ThemeColorMap.HEADER_SECONDARY,textAlign:"center",paddingTop:10,paddingBottom:20}});return n.createElement(N,null,n.createElement(E,{style:t.container},n.createElement(L,{source:{uri:"https://avatars.githubusercontent.com/u/43488869"},style:t.image}),n.createElement(E,{style:t.title},n.createElement(y,{style:t.name},"NoBlockedMessage"),n.createElement(y,{style:t.author},"by mafu"))),n.createElement(T,{title:"SETTING"},n.createElement(i,{label:"Remove replies to blocked user",subLabel:"Whether to show replies to blocked user",leading:n.createElement(i.Icon,{source:O}),trailing:n.createElement(P,{value:o.getBoolean("replies",!0),onValueChange:m=>{o.set("replies",m)}})}),n.createElement(i,{label:"Reload Discord",trailing:i.Arrow,leading:n.createElement(i.Icon,{source:G}),subLabel:"You need to reload Discord if you wanna apply changes to loaded messages too.",onPress:()=>{V()}})),n.createElement(T,{title:"INFORMATION"},n.createElement(i,{label:"Follow me on Twitter",style:t.info,trailing:i.Arrow,leading:n.createElement(i.Icon,{source:Y}),onPress:()=>{S.openURL("https://twitter.com/m4fn3")}}),n.createElement(i,{label:"Visit my server for help",style:t.info,trailing:i.Arrow,leading:n.createElement(i.Icon,{source:z}),onPress:()=>{j.acceptInviteAndTransitionToInviteChannel({inviteKey:"TrCqPTCrdq",context:{location:"Invite Button Embed"},callback:()=>{A.pop()}})}}),n.createElement(i,{label:"Check Source on GitHub",style:t.info,trailing:i.Arrow,leading:n.createElement(i.Icon,{source:U}),onPress:()=>{S.openURL("https://github.com/m4fn3/NoBlockedMessage")}})),n.createElement(y,{style:t.footer},`v${f}`))};const p=I("NoBlockedMessage"),u=v("isBlocked","getFriendIDs"),[C]=[H("MessageStore")],K={...M,onStart(){p.before(C,"LOAD_MESSAGES_SUCCESS",(o,t,m)=>{t[0].messages=t[0].messages.filter(r=>{var s,l;return!u.isBlocked((s=r==null?void 0:r.author)==null?void 0:s.id)&&!(r.referenced_message&&b(g,"replies",!0)&&u.isBlocked((l=r.referenced_message.author)==null?void 0:l.id))})});for(const o of["MESSAGE_CREATE","MESSAGE_UPDATE"])p.before(C,o,(t,m,r)=>{var s,l;let d=m[0].message;(u.isBlocked((s=d==null?void 0:d.author)==null?void 0:s.id)||d.referenced_message&&b(g,"replies",!0)&&u.isBlocked((l=d.referenced_message.author)==null?void 0:l.id))&&(m[0].message={channelId:d.channel.id})})},onStop(){p.unpatchAll()},getSettingsPanel({settings:o}){return n.createElement(q,{settings:o})}};F(K);
